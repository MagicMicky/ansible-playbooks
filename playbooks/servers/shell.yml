---
# Server Shell Setup Playbook
# For servers (minimal configuration for performance)

- name: Configure Server Environment
  hosts: all
  become: false

  vars_files:
    - vars/defaults.yml

  pre_tasks:
    - name: Ensure prerequisites are installed
      ansible.builtin.apt:
        name:
          - zsh
          - git
          - curl
        state: present
        update_cache: true
      become: true
      when: ansible_os_family == "Debian"
      tags: ['prerequisites']

  roles:
    - role: common-shell
      tags: ['shell']

  post_tasks:
    - name: Display server type
      ansible.builtin.debug:
        msg: |
          Server configuration complete for {{ inventory_hostname }}

          Machine type will be auto-detected based on hostname:
          - prod* -> Production (!)
          - dev-* -> Dev server
          - gaming* -> Gaming
          - homelab* -> Homelab
